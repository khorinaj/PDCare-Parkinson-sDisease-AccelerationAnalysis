# Parkinson's disease analysis using MATLAB

## Description
Preprocess real-world, long-term trunk and wrist sensor data collected from PD patients and find correlation between activity related features (based on predictions of activity on ML model) and clinical scales using MATLAB

## Folder Sturcture
.
├── clinicalScales/                # Folder containing clinical scale data for analysis.
├── dataProcessed_Body/            # Processed activity data from trunk sensors.
├── dataProcessed_Wrist/           # Processed activity data from wrist sensors.
├── Info/                          # saved infomration for anlaysis.
├── results/                       # Results of analysis, including correlation maps and statistical outputs.
│   ├── ActivityVisualisation_ID06.png # Visualized activity data for ID 06.
│   ├── BodyKendall.mat            # e.g Kendall correlation results for trunk data will be genearted and saved in this file.
│   ├── BodyKendall.xlsx           # e.g Excel file of Kendall correlation for trunk data will be genearted.
│   ├── CorrelationMapBody.png     # Correlation map visualization for trunk data.
├── utils/                         # Utility scripts for data processing, feature extraction and correlation analysis.
├── main.m                         # Main script for running the pipeline.
├── CorrelationPlot.ipynb          # Jupyter notebook for correlation plots used in the paper.


## Functionality
This project includes the following key components:

1. Data Preprocessing
* Script: preprocessData.m
* Description: Applies filtering and resampling to raw sensor data (both trunk and wrist sensors) to prepare it for analysis. The script outputs normalized data, timestamps, and processed sensor signals.

2. Extract labels
* Script: extractLabelsBody.m (for trunk sensors)
* Description: extend labels predicted by pre-trained machine learning models (from the Python part HARmodel/) to align to the raw data timestamps.

* Script: extractLabelBiobank.m (for wrist sensors)
* Description: Processes labels from wrist sensors by expanding them to to align to the raw data timestamps. Note: this required the preditions is done to the wrist PD data with the tool [NTNU AI-Lab HARTH repository](https://github.com/ntnu-ai-lab/harth-ml-experiments). The labels are generated by author and saved in PDMonitor/PDdata/csvWristData/ActivityIntensity and ActivityType. The default labels in files called id*-timeSeries.csv.

3. Feature Extraction
* Script: extractActivityFeatures.m
* Description: Extracts detailed activity features, such as walking patterns, time spent in various activities, and other descriptive statistics, from trunk and wrist data. Features are chunked into predefined intervals (e.g., 24 hours, 48 hours) for analysis.

4. Correlation Analysis
* Script: correlationAnalysis.m
* Description: Computes correlations between extracted activity features and clinical scales using methods like Kendall, Spearman, and regression. Outputs correlation values and p-values as .mat and .xlsx files.

5. Visualization
* Script: activityVisualizeBody.m
* Description: Generates daily activity visualizations (e.g., walking, sitting/standing) for trunk sensor data, color-coded for each activity.

* File: CorrelationPlot.ipynb
* Description: Advanced plotting of correlation results using Python.

## Outputs
1. Processed Data:
Located in dataProcessed_Body/ID*_processed.mat and dataProcessed_Wrist/ID*_processed.mat.
Includes processed time-aligned sensor data, labels and features for HAR for each ID (patients).

2. Activity Features:
Output from extractActivityFeatures in a table for all participants

3. Correlation Results:
Correlation values and p-values saved in .mat and .xlsx files in the results/ folder.

4. Visualizations:
Activity plots from output of activityVisualizeBody (e.g., ActivityVisualisation_ID06.png) and correlation maps from CorrelationPlot.ipynb (e.g., CorrelationMapBody.png).


## How to Use
### Prerequisites
- MATLAB: Ensure MATLAB is installed with the Signal Processing Toolbox.
- Python: Juypter Notebook.

### PD dataset
- Not included in this Github Project, but can be downloaded in after 31/Jan/2024: 

### Running the Pipeline
run main.m section by section